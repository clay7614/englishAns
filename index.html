<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#6750A4">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon.png?v=4">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png?v=4">
  <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512x512.png?v=4">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png?v=4">
  <title>英語テスト</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
<body>
  <div class="overlay" data-overlay hidden></div>

  <div class="history-panel" data-history-panel hidden>
    <div class="history-panel__header">
      <span class="history-panel__title">学習履歴</span>
      <select class="history-panel__dataset-select" data-history-dataset-select aria-label="問題集でフィルタリング">
        <option value="all">すべての問題集</option>
      </select>
      <select class="history-panel__interval-select" data-history-interval-select aria-label="グラフの表示単位">
        <option value="test">回ごと</option>
        <option value="hour">時間ごと</option>
        <option value="day">日ごと</option>
      </select>
      <div class="history-panel__actions">
        <button type="button" class="history-panel__delete-all" data-delete-all-history title="履歴をすべて削除">
          <span class="material-symbols-outlined">delete</span>
        </button>
        <button type="button" class="history-panel__close" data-close-history>
          <span class="material-symbols-outlined">close</span>
        </button>
      </div>
    </div>
    <div class="history-panel__graph-container">
      <canvas id="historyChart"></canvas>
    </div>
    <div class="history-panel__content" data-history-content>
      <p class="history-panel__empty">履歴はありません。</p>
    </div>
  </div>

  <div class="settings-panel" data-settings-panel hidden>
    <div class="settings-panel__header">
      <span class="settings-panel__title">設定</span>
      <button type="button" class="settings-panel__close" data-close-settings>
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <div class="settings-panel__content">
      <label class="settings-panel__item settings-panel__item--toggle">
        <span class="settings-panel__item-label">自動で進む</span>
        <span class="toggle-switch">
          <input type="checkbox" data-settings-auto-advance checked>
          <span class="toggle-switch__slider" aria-hidden="true"></span>
        </span>
      </label>
      <label class="settings-panel__item settings-panel__item--toggle">
        <span class="settings-panel__item-label">「日本語」ボタンを表示</span>
        <span class="toggle-switch">
          <input type="checkbox" data-settings-translation-control checked>
          <span class="toggle-switch__slider" aria-hidden="true"></span>
        </span>
      </label>
      <label class="settings-panel__item settings-panel__item--toggle">
        <span class="settings-panel__item-label">選択肢をシャッフル</span>
        <span class="toggle-switch">
          <input type="checkbox" data-settings-option-shuffle checked>
          <span class="toggle-switch__slider" aria-hidden="true"></span>
        </span>
      </label>
      <label class="settings-panel__item settings-panel__item--toggle">
        <span class="settings-panel__item-label">ダークモード</span>
        <span class="toggle-switch">
          <input type="checkbox" data-settings-dark-mode>
          <span class="toggle-switch__slider" aria-hidden="true"></span>
        </span>
      </label>
      <label class="settings-panel__item settings-panel__item--toggle">
        <span class="settings-panel__item-label">問題の重複を許可</span>
        <span class="toggle-switch">
          <input type="checkbox" data-settings-duplicates-toggle>
          <span class="toggle-switch__slider" aria-hidden="true"></span>
        </span>
      </label>
    </div>
  </div>

  <main class="app animate-fade-in">
    <header class="app__header">
      <h1>英語テスト</h1>
      <div class="app__dataset-nav">
        <span class="app__dataset-title" data-dataset-title></span>
      </div>
      <p class="app__status" data-status>問題を読み込み中...</p>
      <a href="grammar-study.html" class="app__grammar-link">
        <span class="material-symbols-outlined">menu_book</span>
        文法学習 2A
      </a>
      <div class="app__header-controls">
        <button type="button" class="app__history-button" data-open-history aria-haspopup="true" aria-expanded="false">
          <span class="material-symbols-outlined">history</span>
          履歴
        </button>
        <button type="button" class="app__settings-button" data-open-settings aria-haspopup="true" aria-expanded="false">
          <span class="material-symbols-outlined">settings</span>
          設定
        </button>
      </div>
    </header>
    <section class="start-selection" data-dataset-selection aria-label="問題集一覧">
      <!-- Cards will be injected by app.js -->
    </section>
    <section class="translation-toggle" data-translation-choice hidden>
      <div class="translation-toggle__row">
        <span class="translation-toggle__label">日本語訳を表示</span>
        <span class="toggle-switch">
          <input type="checkbox" data-start-translation-toggle>
          <span class="toggle-switch__slider" aria-hidden="true"></span>
        </span>
      </div>
      <div class="start-options" data-start-options>
        <div class="start-options__group start-options__group--slider">
          <label for="question-count-slider" class="start-options__label">
            出題数: <span data-question-count-display>0</span>問
          </label>
          <input type="range" id="question-count-slider" data-question-count-slider min="1" max="150" value="20">
        </div>
      </div>
      <div class="translation-toggle__buttons">
        <button type="button" class="translation-toggle__button" data-start-quiz>スタート</button>
      </div>
    </section>
    <section class="quiz" data-quiz hidden>
      <div class="quiz__score"><span data-correct>0</span> / <span data-total>0</span> 正解</div>
      <div class="quiz__question" data-question></div>
      <div class="quiz__options" data-options></div>
      <div class="quiz__feedback" data-feedback></div>
      <div class="quiz__controls">
        <button type="button" class="quiz__control-button" data-toggle-translation>日本語: 非表示</button>
        <button type="button" class="quiz__control-button" data-toggle-mode hidden disabled>誤答のみ</button>
        <button type="button" class="quiz__next" data-next disabled>次の問題へ</button>
      </div>
      <div class="quiz__result" data-result hidden></div>
    </section>
  </main>

  <template id="option-button-template">
    <button type="button" class="quiz__option"></button>
  </template>

  <script type="module" src="app.js"></script>
  <script type="module" src="pwa.js"></script>
</body>
</html>
